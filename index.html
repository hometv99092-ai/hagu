<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SIAM Movie AI</title>

<style>
:root{
  --bg:#f1f5f9;
  --text:#000;
  --card:#ffffff;
}
.dark{
  --bg:#0f172a;
  --text:#ffffff;
  --card:#1e293b;
}
body{
  background:var(--bg);
  color:var(--text);
  font-family:Arial;
  padding:20px;
}
h1{text-align:center}

.payment-box{
  background:var(--card);
  padding:15px;
  border-radius:10px;
  text-align:center;
}

input{
  padding:8px;
  width:90%;
  border-radius:6px;
  border:1px solid #ccc;
}

button{
  padding:8px 14px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}

#themeBtn{
  position:fixed;
  top:10px;
  right:10px;
}

#aiBtn{
  position:fixed;
  bottom:20px;
  right:20px;
  background:#22c55e;
  color:white;
  border-radius:50%;
  width:58px;
  height:58px;
  font-size:15px;
}

#aiBox{
  display:none;
  position:fixed;
  bottom:90px;
  right:20px;
  background:var(--card);
  width:260px;
  max-height:500px; /* ‡¶Ü‡¶ó‡ßá‡¶∞ 400px ‚Üí 500px */
  padding:8px;
  border-radius:10px;
  box-shadow:0 0 10px rgba(0,0,0,.3);
  overflow-y:auto;
}

#suggestions{
  display:none;
  max-height:180px;
  overflow:auto;
  margin-top:5px;
}
.sug{
  display:flex;
  gap:8px;
  padding:6px;
  cursor:pointer;
}
.sug img{
  width:38px;
  height:56px;
  object-fit:cover;
  border-radius:4px;
}
.sug:hover{
  background:#3b82f6;
  color:white;
}

#aiResult{
  margin-top:8px;
  display:block;
  font-size:15px;
}
#aiResult img{
  width:70px;
  height:105px;
  object-fit:cover;
  border-radius:4px;
  float:left; 
  margin-right:8px;
  margin-bottom:6px;
}
#aiResult div{
  overflow:hidden;
}
</style>
</head>

<body>

<button id="themeBtn" onclick="toggleTheme()">üåì</button>

<h1>üé¨ SIAM Movie AI</h1>

<div class="payment-box" id="paymentBox">
  <h3>üîê Access</h3>
  <input type="password" id="passInput" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®">
  <br><br>
  <button onclick="unlockAll()">Enter</button>
</div>

<button id="aiBtn" onclick="toggleAI()">AI</button>

<div id="aiBox">
  <input id="aiInput" placeholder="‡¶Æ‡ßÅ‡¶≠‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®...">
  <div id="suggestions"></div>
  <div id="aiResult"></div>
</div>

<script>
const PASSWORD="SIAM2025";
const OMDB_KEY="ac57015f";

/* THEME */
if(localStorage.theme==="dark") document.body.classList.add("dark");
function toggleTheme(){
  document.body.classList.toggle("dark");
  localStorage.theme = document.body.classList.contains("dark")?"dark":"light";
}

/* LOGIN */
function unlockAll(){
  if(passInput.value===PASSWORD){
    localStorage.ok=1;
    paymentBox.style.display="none";
  }else alert("‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°");
}
if(localStorage.ok){
  paymentBox.style.display="none";
}

/* AI toggle */
function toggleAI(){
  if(!localStorage.ok){ alert("‡¶Ü‡¶ó‡ßá ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®"); return; }
  aiBox.style.display = aiBox.style.display==="block"?"none":"block";
  aiInput.focus();
}

/* similarity */
function score(a,b){
  a=a.toLowerCase(); b=b.toLowerCase();
  let m=0; for(let c of a) if(b.includes(c)) m++;
  return m/b.length;
}

let list=[];

/* AUTO SUGGEST + Google Search style */
aiInput.oninput = async ()=>{
  let q = aiInput.value.trim();
  if(q===""){
    suggestions.style.display="none";
    aiResult.innerHTML="";
    return;
  }

  let r = await fetch(`https://www.omdbapi.com/?s=${encodeURIComponent(q)}&apikey=${OMDB_KEY}`);
  let d = await r.json();
  if(d.Response==="False") return;

  list = d.Search.map(x=>({...x,s:score(q,x.Title)}))
           .sort((a,b)=>b.s-a.s).slice(0,5);

  suggestions.innerHTML="";
  list.forEach(m=>{
    let div=document.createElement("div");
    div.className="sug";
    div.innerHTML=`
      <img src="${m.Poster!=="N/A"?m.Poster:"https://via.placeholder.com/40x60"}">
      <div><b>${m.Title}</b><br><small>${m.Year}</small></div>
    `;
    div.onclick=()=>loadMovie(m.imdbID);
    suggestions.appendChild(div);
  });
  suggestions.style.display="block";
};

/* Translate */
async function translateBN(text){
  try{
    let r=await fetch(
      "https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=bn&dt=t&q="
      + encodeURIComponent(text)
    );
    let d = await r.json();
    return d[0].map(i=>i[0]).join("");
  }catch(e){ return text; }
}

/* LOAD MOVIE */
async function loadMovie(id){
  aiResult.innerHTML="‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
  let r = await fetch(`https://www.omdbapi.com/?i=${id}&apikey=${OMDB_KEY}`);
  let d = await r.json();

  let plotBN = await translateBN(d.Plot || "No plot available");

  aiResult.innerHTML = `
    <img src="${d.Poster!=="N/A"?d.Poster:"https://via.placeholder.com/70x105"}">
    <div>
      <b>${d.Title} (${d.Year})</b><br>
      <b>üé≠ ‡¶Ö‡¶≠‡¶ø‡¶®‡ßá‡¶§‡¶æ:</b> ${d.Actors}<br>
      <b>üìñ ‡¶ï‡¶æ‡¶π‡¶ø‡¶®‡¶ø:</b><br>${plotBN}
    </div>
  `;
  suggestions.style.display="none";

  aiInput.focus();
  aiInput.select();
}
</script>

</body>
</html>
